---
title: 关于安卓权限的适配
categories:
  - Android
date: 2018-05-07 20:54:57
updated: 2018-05-07 20:54:57
tags: 
  - Android
---
问题是这样的，刚接触安卓变成，刚开始的时候app一切都正常的，但是突然有一个版本，就不能自动更新了，一点更新就崩溃。因为更新是使用网络上的一个库，实在是头疼。经过检查，才发现，原来是因为权限的问题。小米9，默认的权限获取手机存储是询问，但其实并不会询问，直接就是拒绝了。而手动给了存储权限后，更新就正常了。但是用户不会这么聪明的去查这些东西，肯定就知道一直崩溃崩溃。

# 权限适配
自安卓6.0以后，情况有了变化。在之前的版本中，API23以前，权限写在AndroidManifest.xml文件中，然后安装的时候，就会提示权限，用户允许则安装，不允许，则不能安装。

6.0后，权限进行了分类两大类，敏感权限和普通权限，普通权限默认给予。而敏感权限，首先要在 `AndroidManifest.xml `中声明，然后在使用的时候，动态进行申请。默认的动态申请接口，在一些国产手机系统上被进行了截持，读取到你在 AndroidManifest.xml 内声明了敏感权限，给你返回  true，但是却不是真正的授权。就造成了我所遇到的情况。

所以现在解决的办法就是，适配6.0 或 把适配API降到 23以下。我们采用了后一种方法，因为当前用户量不是很大，毕竟适配起来的话比较恼火，虽然可喜的找到了[这个项目](https://github.com/jokermonn/permissions4m)，作者很强大。但是以后才用了。

# 问题
如果我们选择适配API等级在23以下，即 在build.gradle中指定 `targetSdkVersion level(leve < 23)`。那么在高版本的，API上的话，会是什么结果呢？

是这样的
**对于没有适平配API23以上的APP，而又运行在 6.0以上的系统时，其采用以前的授权方式，即在安装时进行授权。**

# 怎么适配？
参考一下我上面提到的项目，是一个非常棒的项目哦。
